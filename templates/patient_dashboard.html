{% extends "base.html" %}
{% block content %}
<h2>Patient Dashboard</h2>

<p><a href="{{ url_for('patient_create_appointment') }}">Book New Appointment</a></p>

<h3>Upcoming Appointments</h3>
<ul>
{% for appt in upcoming_appointments %}
    <li>
        {{ appt.date_time }} -
        Doctor: {{ appt.doctor.name }} -
        Status: {{ appt.status }}
        {% if appt.status == 'Booked' %}
            | <a href="{{ url_for('patient_cancel_appointment', appointment_id=appt.id) }}">
                Cancel
              </a>
        {% endif %}
    </li>
{% else %}
    <li>No upcoming appointments.</li>
{% endfor %}
</ul>

<h3>Past Appointments</h3>
<ul>
{% for appt in past_appointments %}
    <li>
        {{ appt.date_time }} -
        Doctor: {{ appt.doctor.name }} -
        Status: {{ appt.status }}
        {% if appt.treatment %}
            <br>Diagnosis: {{ appt.treatment.diagnosis }}
            <br>Prescription: {{ appt.treatment.prescription }}
        {% endif %}
    </li>
{% else %}
    <li>No past appointments.</li>
{% endfor %}
</ul>
{% endblock %}
